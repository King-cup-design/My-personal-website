<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>N1 æ¼¢å­—ãƒ†ã‚¹ãƒˆ2</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    h1 { text-align: center; }
    .quiz-box {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      max-width: 700px;
      margin: 0 auto;
    }
    .option-btn {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      font-size: 18px;
      background: #e8e8ff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.2s;
      text-align: left;
    }
    .option-btn:hover { background: #d0d0ff; transform: scale(1.02); }
    .next-btn {
      padding: 12px 20px;
      font-size: 18px;
      background: #4a74ff;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 20px;
    }
    #back-btn {
      padding: 12px 20px;
      font-size: 18px;
      background: #666;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 20px;
      margin-right: 10px;
    }
    .result-box { padding: 20px; max-width: 900px; margin: 0 auto; }
    .result-item { border-bottom: 1px solid #ddd; padding: 10px 0; }
    .correct { color: green; font-weight: bold; }
    .wrong { color: red; font-weight: bold; }
    .notice { background:#fff3cd; border:1px solid #ffeeba; padding:10px; border-radius:8px; margin-bottom:12px; }
  </style>
</head>
<body>

<h1>N1 æ¼¢å­—ãƒ†ã‚¹ãƒˆ 2</h1>

<div class="quiz-box" id="quiz-box">
  <p id="question"></p>
  <div id="options"></div>

  <div style="display:flex; gap:10px;">
    <button id="back-btn" style="display:none;">Back</button>
    <button id="next-btn" class="next-btn" style="display:none;">Next</button>
  </div>
</div>

<script>
/* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼štest1 åˆæ ¼ã—ã¦ã„ãªã„å ´åˆã¯æˆ»ã™ */
const allowed = localStorage.getItem("test1_passed") === "true";
if (!allowed) {
  document.getElementById("quiz-box").innerHTML = `
    <div class="notice">
      <strong>Access denied:</strong> You must pass Test 1 to unlock Test 2.<br>
      <a href="test_list.html">Back to Test List</a>
    </div>
  `;
  throw new Error("Test 2 locked: Test 1 not passed.");
}

/* ====== é¸æŠè‚¢ã‚·ãƒ£ãƒƒãƒ•ãƒ« ====== */
function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

/* ====== æ–°è¦ 15å•ï¼ˆN1ãƒ¬ãƒ™ãƒ«ï¼‰ ======
 å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«:
 q (æ–‡), answer (æ¼¢å­—), reading, meaning_jp, meaning_en, meaning_np, options[]
*/
const quizData = [
  { q: "å½¼ã®èª¬æ˜ã¯æŠ½è±¡çš„ã§ã€å…·ä½“çš„ãªäº‹ä¾‹ãŒãªãã¦ã¯ã€ã‚Šã‹ã„ã€‘ã—ã«ãã„ã€‚",
    answer: "ç†è§£", reading: "ã‚Šã‹ã„", meaning_jp: "ç‰©äº‹ã®æ„å‘³ã‚„å†…å®¹ãŒã‚ã‹ã‚‹ã“ã¨",
    meaning_en: "understanding", meaning_np: "à¤¬à¥à¤à¥à¤¨à¥‡ à¤•à¥à¤·à¤®à¤¤à¤¾",
    options: ["ç†è§£","åˆ©æµ·","ç†ä¼š","æè§£"] },

  { q: "çµŒé¨“è±Šå¯Œãªå½¼å¥³ã®åˆ¤æ–­ã¯å¸¸ã«å†·é™ã§ã€ã›ã„ã—ã‚‡ãã€‘ã ã€‚",
    answer: "çš„ç¢º", reading: "ã¦ãã‹ã", meaning_jp: "æ­£ã—ãã¦ç¢ºã‹ã§ã‚ã‚‹ã“ã¨",
    meaning_en: "precise, accurate", meaning_np: "à¤ à¥€à¤• / à¤¸à¤¹à¥€",
    options: ["çš„ç¢º","é©ç¢º","çš„ç¢ºã•","é©å¯"] },

  { q: "ãã®è£½å“ã¯è€ä¹…æ€§ã«å„ªã‚Œã¦ãŠã‚Šã€é•·æœŸé–“ã®ä½¿ç”¨ã«ã‚‚ã€ãŸãˆã‚‹ã€‘ã€‚",
    answer: "è€ãˆã‚‹", reading: "ãŸãˆã‚‹", meaning_jp: "æˆ‘æ…¢ã™ã‚‹ã€ã“ã‚‰ãˆã‚‹ã“ã¨",
    meaning_en: "to endure", meaning_np: "à¤¸à¤¹à¤¨ à¤—à¤°à¥à¤¨à¥",
    options: ["è€ãˆã‚‹","å ªãˆã‚‹","çµ¶ãˆã‚‹","å ªä¹…"] },

  { q: "æ³•å¾‹ã®æ”¹æ­£ã«ã‚ˆã‚Šã€æ‰‹ç¶šããŒå¤§å¹…ã«ã€ã‹ã‚“ã‚Œã‚“ã€‘ã•ã‚ŒãŸã€‚",
    answer: "ç°¡ç´ ", reading: "ã‹ã‚“ã", meaning_jp: "ç°¡å˜ã§é£¾ã‚ŠãŒå°‘ãªã„ã“ã¨",
    meaning_en: "simple, plain", meaning_np: "à¤¸à¤°à¤²",
    options: ["ç°¡ç´ ","é–¢é€£","ç°¡ç•¥","ç°¡å±¤"] },

  { q: "å½¼ã¯å¤±æ•—ã—ã¦ã‚‚ã‚ã’ãšã«ã€ãŸã¡ãªãŠã‚‹ã€‘åŠ›ãŒã‚ã‚‹ã€‚",
    answer: "ç«‹ã¡ç›´ã‚‹", reading: "ãŸã¡ãªãŠã‚‹", meaning_jp: "æ°—æŒã¡ã‚„æ„æ¬²ã‚’å›å¾©ã™ã‚‹ã“ã¨",
    meaning_en: "to recover (mentally)", meaning_np: "à¤«à¥‡à¤°à¤¿ à¤‰à¤­à¤¿à¤¨à¥",
    options: ["ç«‹ã¡ç›´ã‚‹","ç«‹ç›´ã‚‹","ç«‹ã¡æ²»ã‚‹","é”ã¡ç›´ã‚‹"] },

  { q: "å°é¢¨ã®å½±éŸ¿ã§ã€äº¤é€šæ©Ÿé–¢ã¯å…¨é¢çš„ã«ã€ã¾ã²ã€‘ã—ãŸã€‚",
    answer: "éº»ç—º", reading: "ã¾ã²", meaning_jp: "æ­£å¸¸ãªåƒããŒæ­¢ã¾ã‚‹ã“ã¨",
    meaning_en: "paralysis; disruption", meaning_np: "à¤¸à¥à¤¸à¥à¤¤ à¤¹à¥à¤¨à¥ / à¤…à¤¸à¥à¤¤à¤µà¥à¤¯à¤¸à¥à¤¤ à¤¹à¥à¤¨à¥",
    options: ["éº»ç—º","çœŸå¦","é­”åŒ¹","æ‘©ç—º"] },

  { q: "å½¼å¥³ã¯ç´°éƒ¨ã«ã¾ã§æ³¨æ„ã‚’æ‰•ã„ã€ä»•äº‹ã¯å¸¸ã«ã€ãã¡ã‚‡ã†ã‚ã‚“ã€‘ã ã€‚",
    answer: "å‡ å¸³é¢", reading: "ãã¡ã‚‡ã†ã‚ã‚“", meaning_jp: "ãã¡ã‚“ã¨ã—ã¦ã„ã‚‹ã•ã¾",
    meaning_en: "meticulous, tidy", meaning_np: "à¤µà¤¿à¤¨à¤¿à¤¯à¤®à¤¿à¤¤ / à¤§à¥à¤¯à¤¾à¤¨à¤ªà¥‚à¤°à¥à¤µà¤•",
    options: ["å‡ å¸³é¢","è¦èª¿é¢","èµ·å¸³é¢","æ©Ÿå¸³é¢"] },

  { q: "ç¤¾é•·ã¯ç¤¾å“¡ã®ææ¡ˆã‚’å—ã‘å…¥ã‚Œã€æ–¹é‡ã‚’ã€ã¦ã‚“ã‹ã„ã€‘ã—ãŸã€‚",
    answer: "å±•é–‹", reading: "ã¦ã‚“ã‹ã„", meaning_jp: "ç‰©äº‹ãŒåºƒãŒã£ã¦é€²ã‚€ã“ã¨",
    meaning_en: "development, expansion", meaning_np: "à¤µà¤¿à¤•à¤¾à¤¸ à¤—à¤°à¥à¤¨à¥ / à¤«à¥ˆà¤²à¤¾à¤‰à¤¨à¥",
    options: ["å±•é–‹","å±•ç¤º","å±•é–‹ã—","è»¢é–‹"] },

  { q: "ã“ã®è¨ˆç”»ã¯å®Ÿè¡Œå¯èƒ½æ€§ãŒä½ãã€å†è€ƒãŒã€ã‚ˆã†ãã‚…ã†ã€‘ã•ã‚Œã‚‹ã€‚",
    answer: "è¦è«‹", reading: "ã‚ˆã†ã›ã„", meaning_jp: "å¿…è¦ã ã¨é¡˜ã†ã“ã¨ã€æ±‚ã‚ã‚‹ã“ã¨",
    meaning_en: "request, demand", meaning_np: "à¤…à¤¨à¥à¤°à¥‹à¤§",
    options: ["è¦è«‹","ç”¨æ±‚","è¦æ±‚","è¦ç©¶"] },

  { q: "è¢«ç½åœ°ã§ã¯é£²æ–™æ°´ã®ç¢ºä¿ãŒã€ã•ã£ããã€‘ã®èª²é¡Œã ã£ãŸã€‚",
    answer: "æ—©æ€¥", reading: "ã•ã£ãã‚…ã†", meaning_jp: "éå¸¸ã«æ€¥ãã“ã¨",
    meaning_en: "urgent, prompt", meaning_np: "à¤›à¤¿à¤Ÿà¥‹ / à¤¤à¥à¤°à¥à¤¨à¥à¤¤",
    options: ["æ—©æ€¥","æ—©åŠ","æ—©æ€¥ã«","æ—©æ•‘"] },

  { q: "å•é¡Œã®æœ¬è³ªã‚’è¦‹æŠœãã«ã¯ã€å†·é™ãªã€ã²ã¯ã‚“ã€‘ãŒå¿…è¦ã ã€‚",
    answer: "æ‰¹åˆ¤", reading: "ã²ã¯ã‚“", meaning_jp: "ã‚ˆãè€ƒãˆã¦æ¬ ç‚¹ã‚„å•é¡Œç‚¹ã‚’æŒ‡æ‘˜ã™ã‚‹ã“ã¨",
    meaning_en: "critique, criticism", meaning_np: "à¤†à¤²à¥‹à¤šà¤¨à¤¾",
    options: ["æ‰¹åˆ¤","éåˆ¤","æ‰¹è©•","å¦åˆ¤"] },

  { q: "ã“ã®è³‡æ–™ã¯å°‚é–€çš„ã™ãã¦ä¸€èˆ¬ã«ã¯ã€ã¨ã†ãŒã„ã€‘ã ã€‚",
    answer: "æ•·å±…é«˜ã„", reading: "ã—ãã„ãŒãŸ(ã„)", meaning_jp: "å…¥ã‚Šã«ãã„ã€æ•·å±…ãŒé«˜ã„ã•ã¾",
    meaning_en: "hard to approach, intimidating", meaning_np: "à¤¨à¤œà¤¿à¤•à¤¿à¤¨ à¤—à¤¾à¤¹à¥à¤°à¥‹",
    options: ["æ•·å±…ãŒé«˜ã„","ç™»å¤–","å½“å¤–","æ¸¡å¤–"] },

  { q: "ä¼šè­°ã§ã¯å„éƒ¨é–€ãŒäº’ã„ã®ç«‹å ´ã‚’ã€ã‚Šã‹ã„ã€‘ã—åˆã†ã“ã¨ãŒé‡è¦ã ã€‚",
    answer: "ç†è§£", reading: "ã‚Šã‹ã„", meaning_jp: "ç›¸äº’ã«ã‚ã‹ã‚Šåˆã†ã“ã¨",
    meaning_en: "mutual understanding", meaning_np: "à¤ªà¤°à¤¸à¥à¤ªà¤° à¤¬à¥à¤à¤¾à¤‡",
    options: ["ç†è§£","åˆ©æµ·","ç†ä¼š","ç†è§£ã—"] },

  { q: "æ–°æŠ€è¡“ã®å°å…¥ã§æ¥­å‹™åŠ¹ç‡ãŒè‘—ã—ãã€ã“ã†ã˜ã‚‡ã†ã€‘ã—ãŸã€‚",
    answer: "å‘ä¸Š", reading: "ã“ã†ã˜ã‚‡ã†", meaning_jp: "ç¨‹åº¦ãŒé«˜ããªã‚‹ã“ã¨",
    meaning_en: "improvement, rise", meaning_np: "à¤‰à¤¨à¥à¤¨à¤¤à¤¿",
    options: ["å‘ä¸Š","å…¬ä¸Š","å‘ä¸Šå¿ƒ","é«˜ä¸Š"] },

  { q: "å½¼ã¯å¤šå¿™ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ç´„æŸã¯å¿…ãšã€ã¾ã‚‚ã‚‹ã€‘äººã ã€‚",
    answer: "å®ˆã‚‹", reading: "ã¾ã‚‚ã‚‹", meaning_jp: "ç´„æŸã‚„è¦å‰‡ãªã©ã‚’ç ´ã‚‰ãªã„ã“ã¨",
    meaning_en: "to keep, protect", meaning_np: "à¤°à¤•à¥à¤·à¤¾ à¤—à¤°à¥à¤¨à¥ / à¤ªà¤¾à¤²à¤¨à¤¾ à¤—à¤°à¥à¤¨à¥",
    options: ["å®ˆã‚‹","ä¿ã‚‹","è­·ã‚‹","å®ˆã‚Šã‚‹"] }
];

/* ==== è¨˜éŒ²ç”¨ ==== */
let userAnswers = [];
let current = 0;
let score = 0;

/* ==== åˆæœŸè¡¨ç¤ºé–¢æ•° ==== */
function loadQuiz() {
  const q = quizData[current];
  document.getElementById("question").innerText = (current + 1) + ". " + q.q;

  let html = "";
  shuffle(q.options).forEach(op => {
    html += `<button class="option-btn" onclick="selectOption('${escapeHtml(op)}')">${escapeHtml(op)}</button>`;
  });
  document.getElementById("options").innerHTML = html;

  document.getElementById("next-btn").style.display = "none";
  document.getElementById("back-btn").style.display = current === 0 ? "none" : "block";
}

/* é¸æŠè‚¢ã‚¯ãƒªãƒƒã‚¯ */
function selectOption(choice) {
  // choice ã¯ HTML ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—æ¸ˆã¿ãªã®ã§ã‚¢ãƒ³ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã¯ä¸è¦ã§æ¯”è¼ƒã¯å…ƒå€¤ã¨ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚Šã¾ã™
  // ã“ã“ã§ã¯åŸæ–‡ã® options ã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’å‰æã«ã—ã¦ã„ã‚‹ãŸã‚ã€escapeHtml é©ç”¨æ¸ˆã¿ã®å€¤ã§ä¿å­˜ã—ã¾ã™
  userAnswers[current] = unescapeHtml(choice);

  const q = quizData[current];
  if (userAnswers[current] === q.answer) score++;

  document.getElementById("next-btn").style.display = "block";

  const btns = document.querySelectorAll(".option-btn");
  btns.forEach(b => b.disabled = true);
}

/* Next / Back */
document.getElementById("next-btn").addEventListener("click", () => {
  current++;
  if (current < quizData.length) {
    loadQuiz();
  } else {
    showResult();
  }
});
document.getElementById("back-btn").addEventListener("click", () => {
  if (current > 0) {
    current--;
    loadQuiz();
  }
});

/* çµæœè¡¨ç¤º */
function showResult() {
  const percent = Math.round((score / quizData.length) * 100);
  let html = `
    <div class="result-box">
      <h2>çµæœ</h2>
      <p>${score} / ${quizData.length} æ­£è§£</p>
      <h3>æ­£è§£ç‡ï¼š${percent}%</h3>
  `;

  if (percent >= 90) {
    html += `<p class="correct">åˆæ ¼ï¼ æ¬¡ã®ãƒ†ã‚¹ãƒˆã¸é€²ã‚ã¾ã™ã€‚</p>
             <button class="next-btn" onclick="location.href='test3.html'">Next Test</button>`;
    localStorage.setItem("test2_passed", "true");
  } else {
    html += `<p class="wrong">ä¸åˆæ ¼â€¦ï¼ˆ90% ä»¥ä¸Šã§åˆæ ¼ï¼‰</p>`;
    localStorage.setItem("test2_passed", "false");
  }

  html += `<h2 style="margin-top:20px;">å…¨15å•ã®çµæœ</h2>`;

  quizData.forEach((q, i) => {
    const correct = q.answer;
    const your = userAnswers[i] || "(æœªå›ç­”)";

    html += `
      <div class="result-item">
        <strong>${i+1}. ${q.q}</strong><br>
        <span class="${your === correct ? 'correct' : 'wrong'}">ã‚ãªãŸã®ç­”ãˆï¼š${escapeHtml(your)}</span><br>
        æ­£è§£ï¼š<strong>${escapeHtml(correct)}</strong><br>
        èª­ã¿ï¼š${escapeHtml(q.reading)}<br>
        æ„å‘³ï¼ˆæ—¥æœ¬èªï¼‰ï¼š${escapeHtml(q.meaning_jp)}<br>
        Englishï¼š${escapeHtml(q.meaning_en)}<br>
        Nepaliï¼š${escapeHtml(q.meaning_np)}<br>
      </div>
    `;
  });

  html += `
      <br>
      <button class="next-btn" onclick="location.reload()">Retry</button>
      <br><br>
      <a href="test_list.html">Back to List</a>
    </div>
  `;

  document.getElementById("quiz-box").innerHTML = html;
}

/* HTML ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é–¢æ•°ï¼ˆå®‰å…¨è¡¨ç¤ºã®ãŸã‚ï¼‰ */
function escapeHtml(str) {
  if (str === undefined || str === null) return "";
  return String(str)
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;")
    .replaceAll('"', "&quot;")
    .replaceAll("'", "&#39;");
}
function unescapeHtml(str) {
  if (str === undefined || str === null) return "";
  return String(str)
    .replaceAll("&amp;","&")
    .replaceAll("&lt;","<")
    .replaceAll("&gt;",">")
    .replaceAll("&quot;","\"")
    .replaceAll("&#39;","'");
}

/* åˆæœŸè¡¨ç¤º */
loadQuiz();

</script>
<!-- ğŸ”™ Back ãƒœã‚¿ãƒ³ï¼ˆãƒšãƒ¼ã‚¸ä¸€ç•ªä¸‹ãƒ»ä¸­å¤®ï¼‰ -->
<div style="text-align:center; margin-top:40px; margin-bottom:40px;">
  <button 
    style="
      padding: 14px 30px;
      font-size: 20px;
      background: linear-gradient(90deg, #4a74ff, #9a5bff);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    " 
    onclick="history.back()">
    â† Backï¼ˆæˆ»ã‚‹ï¼‰
  </button>
</div>

</body>
</html>
